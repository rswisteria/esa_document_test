---
title: "esa導入に関して"
category: インフラ/メモ
tags: 
created_at: 2017-04-21 12:56:23 +0900
updated_at: 2017-04-26 21:53:14 +0900
published: true
number: 331
---

# 現状

https://github.com/xtone/esa_documents に待避
同期させるようにしているので、とりあえずShip Itしたほうがいいんじゃなかろうか。

全ドキュメントの同期が出来ない…！？

# 提案

- プロジェクト毎で採用
    - ドキュメント編集を行うメンバーだけ契約すればいいかと
        - 藤川さんがプロジェクトいっぱい抱えていて、それぞれで利用しているのでどうしたもんか
            - 博報堂、秋田書店でだいたい足りる？
- インフラチームはドキュメントベースでの議論・共有が活発なので、採用したいです
    - インフラ定例の予定を入れているメンバーは9人 (実働7人)
        - 実働メンバーのみ契約すると、月額3,500JPY (年間42,000JPY)
    - インフラ管理で全員が閲覧する必要のある情報は、自動的に別のwikiに連携する仕組みを導入する
        - backlogかgithubあたり

# 導入に関して

## 導入の目的

- ドキュメント管理ツールを外部サービスにしたかった
    - 社内サーバ減らして、インフラの負担減らそう計画の一環
        - ドキュメント管理は特に可用性・耐障害性が求められて結構大変
            - 必要なときに見られないと困るとか
            - データ飛ぶとめちゃくちゃ困るとか

## 導入の要件

- 外部サービスであること
- Markdownが利用できること
    - 一昔前はwiki毎に色々文法があって、覚えるのが面倒だった
    - 最近はgithubとか様々な箇所で、ほぼmarkdown形式がデファクト
- 編集しやすい
    - リアルタイムプレビュー

## 検討候補

- Qiita.Team
- DocBase
- Confluence
- esa.io

## esa.ioを選定した理由

- Googleアカウントによるログイン
- フローからストックというサービスの思想に共感
- タグとカテゴリという2種類の情報整理方法
- Github拡張のMarkdownサポート
    - チェックボックス使えるのがめちゃくちゃ大きい

# 実際にesa.ioを試用してみて

## UIがよく出来てる

- リアルタイムプレビュー
- 記事カテゴリの移動・編集が容易
- Ctrl+Sで保存
- エディタの補完がよく出来ている
    - 箇条書き多用するスタイルならとても便利
    - あと表とか

## Work in Progressステータスが便利

- とりあえずのメモ書きを起こす頻度が増え、そこから必要な人に共有するケースが出来た
    - インフラ系の情報整理時等で
    - 思いつきレベルの共有
    - たたき台作ってからの議論

## PlantUML対応が超便利

 - UML等の図がテキストでさっくり書ける
     - シーケンス図とかクラス図の作成・共有のコストがめちゃくちゃ下がった
     - ドキュメント内に自然に図を書くようになった

### こんなのとか (シーケンス図)

```uml
actor 店舗スタッフ

店舗スタッフ -> トレタ : 来店処理
activate トレタ

トレタ -> Square : 伝票の作成
activate Square

トレタ <-- Square : Square伝票ID
deactivate Square
deactivate トレタ

店舗スタッフ -> Square : 注文処理
activate Square

Square ->> トレタ :  伝票ステータス変更の通知
activate トレタ
deactivate Square

トレタ -> Square : 伝票情報取得
activate Square

トレタ <-- Square : 伝票情報(席のステータス、注文情報、etc)
deactivate Square
deactivate トレタ

店舗スタッフ -> Square : 会計処理
activate Square

Square ->> トレタ : 会計完了の通知
activate トレタ
deactivate Square

トレタ -> Square : 会計情報取得
activate Square

トレタ <-- Square : 会計情報(注文情報、支払い情報、etc)
deactivate Square

トレタ -> トレタ : 予約に会計情報の紐付け
deactivate トレタ
```

### こんなのとか (ユースケース図)

```uml
actor 店舗スタッフ
actor 店舗責任者
店舗スタッフ <|-- 店舗責任者

店舗責任者 -> (トレタ-Square連携設定)
店舗スタッフ -> (来店処理)
店舗スタッフ -> (注文処理)
店舗スタッフ -> (会計処理)
```

### こんなのとか (コンポーネント図)

```uml
node Square {
  [伝票管理] 
  SquareAPI - [会計管理]
}

package POSコネクト {
  [伝票管理] --> コールバックURL
  [Square伝票管理] --> SquareAPI
  POSコネクトAPI - [Square伝票管理]
  コールバックURL - [イベントハンドラ]
}

package トレタ {
  トレタAPI - [予約管理]
  [Square伝票発行]
  [イベントハンドラ] --> トレタAPI
  [Square伝票発行] --> POSコネクトAPI
}
```

## テンプレート機能が便利

- 文章テンプレート機能があるので、フォーマットそろえたい時に便利
    - 議事録とか日報とかに最適
    - 設計ドキュメントとかも
 
## WebHoookサポートが便利

- 外部サービスとの連携
  - Slackへの通知とか
  - 最近はGitHubへの同期もサポート（現在β版）
  - 自分でコード書けばもっと色々出来る

## 添付ファイルの管理が便利

- 添付ファイルの管理方法がコントロール可能
    - esaに預ける
    - 自前で管理しているS3に上げる

## スライドショー機能が便利

- 自然にこんなの（プレゼン中を想定）が作れます

# esa.ioを導入するに当たっての懸念点

## 閲覧範囲制限機能が弱い

  - 特定のユーザーに公開する機能が無い
  - お金払っているユーザー → 外部公開 (推測できないURLによるもの) の2つしかない
      - 編集しないけど閲覧はする必要がある、というユーザーに対してもお金を払う必要がある
          - devwikiの場合で考えると、更新する人はほぼ限られてるが、閲覧はほぼ全員がしている

## 運営母体に対する心配

- 情報漏洩等の心配
- サービス継続性の心配

## 外部サービス増えてきた問題

- 使わなければいけないツールが増えてきて、スタッフの負荷が高くなっている
    - そもそも負荷軽減を目的に導入を進めているので、負荷が増えるとなれば本末転倒

# 導入形態

- 会社で契約
- プロジェクトで契約

# 会社として全社員分のライセンス契約の場合

## メリット

- プロジェクトを超えた、横断的な情報共有が可能
    - 会社全体のドキュメントベースとして一本化が出来る
    - みんなちゃんとドキュメント書くようになって欲しい気持ち

## デメリット

- 割高感あるコスト
    - 年間20万円弱
    - 社員全員が前述のメリットを現状で享受できない
        - ツール以前にいろいろな文化の醸成が必要
        - そのためのツールという考え方

# 利用するプロジェクト毎での契約の場合

## メリット

- 納得感のあるコスト
    - 必要最低限の契約数ですむ
    - 採用するプロジェクトならば利用目的が明確なため、コストが無駄になる感じはあまりない

## デメリット

- プロジェクトが終了すると解約する形になると、情報のストックとしては微妙
    - Markdownでダンプは出来るのでバックアップは容易
    - Markdownをサポートする他のドキュメントツールへのインポートも容易なので、一応データ移行は出来る
    - WIPでない記事は全部Github wikiへ同期するとよさげ？
- プロジェクトから独立した情報の、プロジェクト外への共有が出来ない
    - 技術メモ的なものだったり
    - アイデアメモ的なものだったり
    - それを行うためにwiki.xtone.localを立ち上げた経緯はあるが、最近はそのような目的であまり使われていない
        - ツールの使い勝手の問題が大きい?
        - 単純にやる気の問題? そういうニーズが存在しない?
- 複数プロジェクトに関わっている人の契約問題
    - プロジェクト毎に別契約
        - 同じ人に対して二重に払うケースも発生する
        - 契約自体は会社で1つにする?
             - お金の出所の管理にコストが掛かる
- 知識や考え方がプロジェクト毎で分断される
    - プロジェクト毎では無く、チーム毎（エンジニア・ディレクター・デザイナー等）で共有されるべき情報もある

